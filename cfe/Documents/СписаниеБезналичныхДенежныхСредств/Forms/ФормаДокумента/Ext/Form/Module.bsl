
&НаКлиенте
&Вместо("РасшифровкаПлатежаЗаказНачалоВыбора")
Процедура ВИЛС_РасшифровкаПлатежаЗаказНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	ЗначенияОтбора = Новый Структура;
	
	ОплатаМеждуОрганизациями = Объект.ХозяйственнаяОперация = ПредопределенноеЗначение("Перечисление.ХозяйственныеОперации.ОплатаДенежныхСредствВДругуюОрганизацию");
	ВозвратМеждуОрганизациями = Объект.ХозяйственнаяОперация = ПредопределенноеЗначение("Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствВДругуюОрганизацию");
	Если ОплатаМеждуОрганизациями Или ВозвратМеждуОрганизациями Тогда
		МассивОрганизаций = Новый Массив();
		МассивОрганизаций.Добавить(Объект.Организация);
		МассивОрганизаций.Добавить(ОрганизацияПолучатель);
		
		ЗначенияОтбора.Вставить("Организация", МассивОрганизаций);
		ЗначенияОтбора.Вставить("Контрагент", МассивОрганизаций);
		ЗначенияОтбора.Вставить("Партнер", ПредопределенноеЗначение("Справочник.Партнеры.НашеПредприятие"));
	Иначе
		ЗначенияОтбора.Вставить("Организация", Объект.Организация);
		ЗначенияОтбора.Вставить("Контрагент", Объект.Контрагент);
	КонецЕсли;
	
	ЭтоРасчетыСклиентами = ВозвратМеждуОрганизациями Или ФинансыКлиент.ЭтоРасчетыСКлиентами(Объект.ХозяйственнаяОперация);
	
	НастройкиВыбора = ФинансыКлиент.ПараметрыВыбораДокументаРасчетов();
	НастройкиВыбора.РедактируемыйДокумент = Объект.Ссылка;
	НастройкиВыбора.ЭтоРасчетыСКлиентами = ЭтоРасчетыСклиентами;
	НастройкиВыбора.Валюта = Объект.Валюта;
	НастройкиВыбора.Сумма = Элементы.РасшифровкаПлатежа.ТекущиеДанные.Сумма;
	
	//++ НЕ УТ
	Если Объект.ПлатежиПо275ФЗ и Объект.СуммаДокумента > 3000000 Тогда //fix Клещ А.Н. платеж не по ГОЗ за счет средств ГОЗ
		ЗначенияОтбора.Вставить("ПлатежиПо275ФЗ", Истина);
	КонецЕсли;
	//-- НЕ УТ
	
	ФинансыКлиент.ДокументРасчетовНачалоВыбора(ЗначенияОтбора, НастройкиВыбора, Элемент, СтандартнаяОбработка);
	
КонецПроцедуры

&НаКлиенте
&После("РасшифровкаПлатежаЗаказОбработкаВыбора")
Процедура ВИЛС_РасшифровкаПлатежаЗаказОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	СтрокаТаблицы = Элементы.РасшифровкаПлатежа.ТекущиеДанные;
	ВИЛС_ЗаполнитьПодразделениеПоОснованию(Объект.Подразделение, СтрокаТаблицы.Заказ, Объект.Договор);
КонецПроцедуры
 
&НаСервереБезКонтекста                                                            
Процедура ВИЛС_ЗаполнитьПодразделениеПоОснованию(Подразделение, Знач Заказ, Знач Договор)   
	Если ЗначениеЗаполнено(Заказ)
		и Не Заказ.Метаданные().Реквизиты.Найти("Подразделение") = Неопределено
			и ЗначениеЗаполнено(Заказ.Подразделение) Тогда
	    Подразделение = Заказ.Подразделение;
	Иначе	
		Подразделение = Договор.Подразделение;
	КонецЕсли; 
КонецПроцедуры